â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         ğŸ“¦ COMMENT PUBLIER UNE NOUVELLE VERSION CHIASMA          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

EXEMPLE : Passer de v1.0.2 Ã  v1.0.3

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ã‰TAPE 1 : MODIFIER PUBSPEC.YAML
--------------------------------

ğŸ“ Fichier : pubspec.yaml
ğŸ“ Ligne 17

AVANT:
  version: 1.0.2+102

APRÃˆS:
  version: 1.0.3+103
         â†‘     â†‘
         â”‚     â””â”€ Build number (incrÃ©menter +1)
         â””â”€ Version affichÃ©e

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ã‰TAPE 2 : MODIFIER CLOUD FUNCTION
----------------------------------

ğŸ“ Fichier : functions/src/versionCheck.ts
ğŸ“ Lignes 12-23

AVANT:
  const LATEST_VERSION = {
    version: "1.0.2",
    buildNumber: 102,
    message: "...",
    forceUpdate: false,
    features: [...]
  };

APRÃˆS:
  const LATEST_VERSION = {
    version: "1.0.3",              â† Changer version
    buildNumber: 103,              â† Changer build (+1)
    message: "Nouvelles fonctionnalitÃ©s et corrections",
    forceUpdate: false,            â† true = obligatoire
    features: [
      "âœ¨ Nouvelle fonctionnalitÃ© X",
      "ğŸ› Correction du bug Y",
      "âš¡ Performance amÃ©liorÃ©e",
    ],
    releaseDate: "2025-11-15",     â† Date de sortie
    downloadUrl: "https://chiasma.pro/telecharger.html",
  };

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ã‰TAPE 3 : DÃ‰PLOYER CLOUD FUNCTION
----------------------------------

Terminal:

  cd /home/user/myapp/functions
  npm run build
  cd ..
  firebase deploy --only functions:getAppVersion,functions:checkAppVersion

Attendez:
  âœ“ functions[getAppVersion] Successful update operation.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ã‰TAPE 4 : COMPILER APK FLUTTER
-------------------------------

Terminal:

  cd /home/user/myapp
  flutter build apk --release

Attendez (2-3 minutes):
  âœ“ Built build/app/outputs/flutter-apk/app-release.apk (61.3MB)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ã‰TAPE 5 : TESTER LOCALEMENT
----------------------------

Terminal - Tester l'endpoint:

  curl https://us-central1-chiasma-android.cloudfunctions.net/getAppVersion

VÃ©rifier:
  {
    "version": "1.0.3",     â† Doit afficher la nouvelle version
    "buildNumber": 103,     â† Doit afficher le nouveau build
    ...
  }

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ã‰TAPE 6 : UPLOADER APK SUR SERVEUR
-----------------------------------

1. Copier l'APK:
   ğŸ“ build/app/outputs/flutter-apk/app-release.apk

2. Renommer (optionnel):
   chiasma-v1.0.3.apk

3. Uploader sur serveur web:
   https://chiasma.pro/telecharger.html

4. Mettre Ã  jour la page tÃ©lÃ©chargement avec le nouveau lien

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ã‰TAPE 7 : TESTER SUR TÃ‰LÃ‰PHONE
-------------------------------

1. Installer ANCIENNE version (1.0.2) sur un tÃ©lÃ©phone test

2. Ouvrir l'app â†’ ParamÃ¨tres â†’ "VÃ©rifier les mises Ã  jour"

3. VÃ©rifier que dialogue s'affiche:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  ğŸ”„ Mise Ã  jour disponible          â”‚
   â”‚                                      â”‚
   â”‚  Nouvelles fonctionnalitÃ©s...       â”‚
   â”‚                                      â”‚
   â”‚  Version actuelle:      1.0.2       â”‚
   â”‚  Nouvelle version:      1.0.3       â”‚
   â”‚                                      â”‚
   â”‚  âœ¨ Nouvelle fonctionnalitÃ© X       â”‚
   â”‚  ğŸ› Correction du bug Y             â”‚
   â”‚                                      â”‚
   â”‚  [Plus tard]  [TÃ©lÃ©charger]         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

4. Cliquer "TÃ©lÃ©charger" â†’ VÃ©rifier redirection vers site

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš ï¸  MISE Ã€ JOUR OBLIGATOIRE (OPTIONNEL)
----------------------------------------

Pour FORCER les utilisateurs Ã  mettre Ã  jour:

Dans functions/src/versionCheck.ts:

  const LATEST_VERSION = {
    forceUpdate: true,  â† Mettre Ã  true
    // ...
  };

Effet:
  - âŒ Pas de bouton "Plus tard"
  - âš ï¸  Message d'avertissement
  - ğŸš« Impossible de continuer sans mise Ã  jour

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ CHECKLIST COMPLÃˆTE
---------------------

Avant de publier, vÃ©rifier:

  â˜ pubspec.yaml modifiÃ© (version + buildNumber)
  â˜ versionCheck.ts modifiÃ© (version, build, message, features)
  â˜ Cloud Function dÃ©ployÃ©e (getAppVersion)
  â˜ Endpoint testÃ© (curl)
  â˜ APK compilÃ©e (flutter build apk)
  â˜ APK uploadÃ©e sur serveur
  â˜ Page tÃ©lÃ©chargement mise Ã  jour
  â˜ Test sur tÃ©lÃ©phone (ancienne version)
  â˜ Dialogue de mise Ã  jour s'affiche correctement
  â˜ Bouton tÃ©lÃ©charger fonctionne

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”— COMMANDES RAPIDES
--------------------

# Tout en une fois:
cd /home/user/myapp
cd functions && npm run build && cd ..
firebase deploy --only functions:getAppVersion,functions:checkAppVersion
flutter build apk --release

# Tester:
curl https://us-central1-chiasma-android.cloudfunctions.net/getAppVersion

# Logs:
firebase functions:log --only getAppVersion

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ’¡ CONSEILS
-----------

âœ“ Toujours incrÃ©menter buildNumber (+1)
âœ“ Tester endpoint AVANT de compiler APK
âœ“ Garder un historique des versions
âœ“ Ne pas utiliser forceUpdate sauf si critique
âœ“ DÃ©crire clairement les changements dans features[]
âœ“ Tester sur plusieurs appareils si possible

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ EN CAS DE PROBLÃˆME
---------------------

ProblÃ¨me: Endpoint retourne 404
â†’ VÃ©rifier dÃ©ploiement: firebase functions:list

ProblÃ¨me: App n'affiche pas de mise Ã  jour
â†’ VÃ©rifier buildNumber dans pubspec.yaml vs versionCheck.ts

ProblÃ¨me: Dialogue ne s'affiche pas
â†’ VÃ©rifier logs: firebase functions:log --only getAppVersion

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Fait comme un pro ! ğŸ’ª
